<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>ลงทะเบียนรับประกันป้ายพิมพ์ UV</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; padding: 20px; background-color: #f7f7f7; }
    .container { background: #fff; padding: 20px; border-radius: 10px; max-width: 600px; margin: auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    h2 { color: #333; }
    label { display: block; margin-top: 10px; }
    input, textarea, button { width: 100%; padding: 10px; margin-top: 5px; border-radius: 5px; border: 1px solid #ccc; }
    .hidden { display: none; }
    .btn { background-color: #000; color: #FFD700; font-weight: bold; cursor: pointer; border: none; }
    .btn:hover { background-color: #333; }
    .notice { color: green; margin-top: 20px; text-align: center; }
  </style>
</head>
<body>
  <div class="container">
    <h2>ลงทะเบียนรับประกันป้ายพิมพ์ UV</h2>

    <button onclick="toggleWarranty()">อ่านข้อความเงื่อนไขการรับประกัน</button>
    <div id="warrantyText" class="hidden">
      <p>เรียน ลูกค้าผู้มีอุปการคุณ,</p>
      <p>... เพื่อเป็นการยืนยันคุณภาพและสร้างความมั่นใจในสินค้าและบริการของเรา บริษัทฯ ขอมอบการรับประกันคุณภาพสีสำหรับงานป้ายพิมพ์ UV เป็นระยะเวลา 1 ปีเต็ม นับจากวันที่ติดตั้ง โดยมีรายละเอียดและเงื่อนไขดังต่อไปนี้

มาตรา 1: ขอบเขตการรับประกัน (สิ่งที่คุ้มครอง)
บริษัทฯ รับประกันการซีดจางของสี (Color Fading) ที่เกิดจากกระบวนการผลิตและคุณภาพของหมึกพิมพ์ UV ของทางบริษัทฯ เท่านั้น
การรับประกันนี้ครอบคลุมเฉพาะการเปลี่ยนแปลงของเม็ดสีที่ซีดจางลงอย่างมีนัยสำคัญเมื่อเทียบกับสภาพแรกติดตั้ง ภายใต้การใช้งานในสภาวะปกติ
การดำเนินการเมื่อเข้าเงื่อนไข: บริษัทฯ จะดำเนินการผลิตชิ้นงานใหม่ให้ เฉพาะส่วนที่เกิดปัญหา โดยใช้ไฟล์งานเดิม และไม่รวมถึงค่าใช้จ่ายในการรื้อถอน, การขนส่ง และการติดตั้งใหม่
มาตรา 2: ข้อยกเว้นสำคัญ (สิ่งที่ไม่คุ้มครอง)
การรับประกันนี้ ไม่ครอบคลุม ความเสียหายในกรณีดังต่อไปนี้:
2.1 ความเสียหายทางกายภาพ (Physical Damage):
รอยขีดข่วน, รอยถลอก, การเสียดสี, การกระแทก, การบิดงอ, การฉีกขาด หรือการแตกหักของวัสดุ
สีที่หลุดร่อนจากการสัมผัส, การแกะ, การลอก หรือการติดตั้งวัตถุอื่นทับบนชิ้นงาน
2.2 ความเสียหายจากสภาพแวดล้อมและการใช้งานผิดประเภท (Environmental & Improper Use Damage):
การติดตั้งในพื้นที่ที่สัมผัสกับความร้อนสูง, เปลวไฟ, หรือไอน้ำ/ไอสารเคมีเข้มข้นตลอดเวลา
การสัมผัสกับสารเคมีทุกชนิด เช่น ทินเนอร์, แอลกอฮอล์, น้ำมัน, กรด-ด่าง หรือน้ำยาทำความสะอาดที่มีฤทธิ์กัดกร่อน
การทำความสะอาดผิดวิธี เช่น การใช้แปรงขนแข็ง, สก๊อตไบร์ท, หรือวัสดุมีคมในการขัดถู
2.3 ความเสื่อมสภาพตามธรรมชาติและเหตุสุดวิสัย (Natural Wear & Force Majeure):
การเปลี่ยนแปลงของเฉดสีเพียงเล็กน้อย (Slight Color Shift) ซึ่งไม่สามารถสังเกตเห็นได้ชัดเจนในระยะปกติ
ความเสียหายจากภัยธรรมชาติ เช่น อุทกภัย, วาตภัย, อัคคีภัย, แผ่นดินไหว รวมถึงความเสียหายจากสัตว์หรือแมลง
2.4 การดัดแปลงและติดตั้ง (Modification & Installation):
ความเสียหายที่เกิดจากการดัดแปลง, แก้ไข, หรือซ่อมแซมชิ้นงานโดยบุคคลภายนอกที่ไม่ใช่ทีมงานของบริษัทฯ
ความเสียหายที่เกิดจากการรื้อถอนและนำไปติดตั้งใหม่ด้วยตนเอง
มาตรา 3: กระบวนการและเงื่อนไขการรับสิทธิ์
3.1 การลงทะเบียน: ลูกค้า ต้อง ดำเนินการลงทะเบียนเพื่อรับสิทธิ์ผ่าน LINE Official Account ของบริษัทฯ ภายใน 15 วัน นับจากวันที่ติดตั้งสินค้า โดยต้องกรอกข้อมูลให้ครบถ้วนและแนบภาพถ่ายชิ้นงานหลังการติดตั้งเป็นหลักฐาน หากไม่ลงทะเบียนภายในเวลาที่กำหนด จะถือว่าท่านสละสิทธิ์การรับประกันโดยสมบูรณ์
3.2 การแจ้งเคลม:ติดต่อผ่าน LINE Official Account: พร้อมแจ้งชื่อและเบอร์โทร
ส่งภาพถ่าย 2 ภาพ:
ภาพถ่ายระยะไกลที่เห็นภาพรวมของป้ายในบริเวณที่ติดตั้ง
ภาพถ่ายระยะใกล้ (Close-up) บริเวณที่เกิดปัญหาสีซีดจาง
บริษัทฯ จะใช้เวลาประเมินเบื้องต้นจากภาพถ่ายภายใน 3-5 วันทำการ
ในบางกรณี บริษัทฯ อาจร้องขอการตรวจสอบชิ้นงานจริง ณ สถานที่ติดตั้ง
3.3 การตัดสิน: การพิจารณาและตัดสินของบริษัทฯ ถือเป็นที่สิ้นสุด
คำแนะนำในการดูแลรักษา:
เพื่อรักษาสภาพสีให้สวยงามยาวนาน ควรใช้ผ้าไมโครไฟเบอร์ชุบน้ำสะอาดบิดหมาดเช็ดทำความสะอาดเท่านั้น และหลีกเลี่ยงการใช้น้ำยาหรือสารเคมีทุกชนิด ...</p>
    </div>

    <label>
      <input type="checkbox" id="agreeCheckbox"> ฉันได้อ่านและยอมรับเงื่อนไขการรับประกัน
    </label>

    <div id="formSection" class="hidden">
      <label>ชื่อ-สกุล</label>
      <input type="text" id="fullname">

      <label>เบอร์โทร</label>
      <input type="tel" id="phone">

      <label>วันที่ติดตั้ง</label>
      <input type="date" id="installDate">

      <label>กรุณาอัพโหลดรูปภาพมุมกว้าง</label>
      <input type="file" id="widePhoto" accept="image/*">

      <button class="btn" onclick="submitForm()">บันทึกข้อมูล</button>

      <div id="loadingMsg" class="notice hidden">กำลังบันทึกข้อมูล...</div>
      <div id="successMsg" class="notice hidden">
        บันทึกข้อมูลเรียบร้อยแล้ว<br>
        <button class="btn" onclick="closeWindow()">ปิดหน้าต่างนี้</button>
      </div>
    </div>
  </div>

  <script>
    const agreeCheckbox = document.getElementById('agreeCheckbox');
    const formSection = document.getElementById('formSection');

    agreeCheckbox.addEventListener('change', () => {
      formSection.classList.toggle('hidden', !agreeCheckbox.checked);
    });

    function toggleWarranty() {
      const text = document.getElementById('warrantyText');
      text.classList.toggle('hidden');
    }

    function submitForm() {
      const fullname = document.getElementById('fullname').value;
      const phone = document.getElementById('phone').value;
      const date = document.getElementById('installDate').value;
      const widePhoto = document.getElementById('widePhoto').files[0];

      if (!fullname || !phone || !date || !widePhoto) {
        alert('กรุณากรอกข้อมูลให้ครบถ้วน');
        return;
      }

      document.getElementById('loadingMsg').classList.remove('hidden');

      // ใช้ Google Apps Script Web App URL
      const scriptURL = 'https://script.google.com/macros/s/AKfycbzAjwUwwsiJcpSssKqD9q1jQNcXOUUU8lAI8b4_hnJj6M_24DO-VM8AwKsg496GXj4gmQ/exec';
      const formData = new FormData();
      formData.append('fullname', fullname);
      formData.append('phone', phone);
      formData.append('installDate', date);
      formData.append('widePhoto', widePhoto);
      formData.append('userid', 'LINE_USER_ID'); // จะถูกแทนด้วย LIFF SDK จริง

      fetch(scriptURL, { method: 'POST', body: formData })
        .then(response => response.text())
        .then(result => {
          document.getElementById('loadingMsg').classList.add('hidden');
          document.getElementById('successMsg').classList.remove('hidden');
          sendFlexMessage(fullname, phone);
        })
        .catch(error => {
          alert('เกิดข้อผิดพลาดในการส่งข้อมูล');
          console.error(error);
        });
    }

    function closeWindow() {
      window.close();
    }

    function sendFlexMessage(fullname, phone) {
      if (window.liff) {
        liff.sendMessages([
          {
            type: 'flex',
            altText: 'การลงทะเบียนรับประกันสินค้าสำเร็จ',
            contents: {
              type: 'bubble',
              body: {
                type: 'box',
                layout: 'vertical',
                contents: [
                  { type: 'text', text: 'ลงทะเบียนสำเร็จ!', weight: 'bold', size: 'xl' },
                  { type: 'text', text: `ชื่อ: ${fullname}`, margin: 'md' },
                  { type: 'text', text: `เบอร์โทร: ${phone}` }
                ]
              }
            }
          }
        ])
      }
    }
  </script>

  <!-- LINE LIFF SDK -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script>
    liff.init({ liffId: "2007688681-VmqQx7q5" })
      .then(() => {
        if (!liff.isLoggedIn()) liff.login();
      });
  </script>
</body>
</html>
